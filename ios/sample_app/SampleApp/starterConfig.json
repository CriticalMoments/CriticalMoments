{
  "configVersion": "v1",
  "TODO": "you must replace appID with your app ID (aka, bundle ID)",
  "appId": "io.criticalmoments.demo-app",
  "triggers": {
    "namedTriggers": {
      "usedKeyFeatureReviewTrigger": {
        "TODO": "This trigger requests the user rate the app, after they perform a key action in the app. See the smartReview action to understand the conditions which make it 'smart' (checking battery level, checking frequency, etc). To implement: 1) fire events in-code after an in-app actions (one you want to show the review prompt after), 2) update the eventName below to the name of the event you created in #1",
        "eventName": "KEY_FEATURE_USED",
        "actionName": "smartReviewAction"
      },
      "keyFeatureTwoReviewTrigger": {
        "TODO": "Similar to 'usedKeyFeatureReviewTrigger', but adds a condition. In this example, only asking every 4th time they complete the action. To implement: 1) fire events in-code after an in-app actions (one you want to show the review prompt after), 2) update the eventName below to the name of the event you created in #1, 3) Update 'condition' with the logic you want.",
        "eventName": "KEY_FEATURE_2_USED",
        "condition": "eventCount('KEY_FEATURE_2_USED') > 4",
        "actionName": "smartReviewAction"
      },
      "showPaywallDay7Trigger": {
        "TODO": "A trigger to show your paywall after 7 days. See the 'smartPaywallReminderAction' for what makes this smart (checking battery level, checking if distracted). To implement 1) implement a deeplink to your paywall in code, and update the link in 'smartPaywallReminderAction'. 2) implement the properties used in the smartPaywallReminderAction, such as 'has_paid_subscription' and 'completed_onboarding'.",
        "actionName": "smartPaywallReminderAction",
        "condition": "eventCount('action:smartPaywallReminderAction') == 0 && app_install_date < now() - duration('168h')",
        "eventName": "app_start"
      },
      "showPaywallDay21Trigger": {
        "TODO": "A trigger to show your paywall after 21 days. See description of showPaywallDay7Trigger for details. Note: this condition assumes you kept showPaywallDay7Trigger, and waits for it to occur once before starting the 21 day timer (see the condition).",
        "actionName": "smartPaywallReminderAction",
        "condition": "eventCount('action:smartPaywallReminderAction') == 1 && app_install_date < now() - duration('504h')",
        "eventName": "app_start"
      },
      "showPaywallMonthlyTrigger": {
          "TODO": "A trigger to show your paywall once a month, after. See description of showPaywallDay7Trigger for details. Note: this condition assumes you kept showPaywallDay7Trigger and showPaywallDay21Trigger, and waits them to occur before starting the 21 day timer (see the condition).",
        "actionName": "smartPaywallReminderAction",
        "condition": "eventCount('action:smartPaywallReminderAction') > 1 && latestEventTime('action:smartPaywallReminderAction') < now() - duration('720h')",
        "eventName": "app_start"
      },
      "showProBanner": {
          "TODO": "This trigger can show a banner suggesting subscribing, when the app starts. Currently disabled as the condition is 'false'; set to 'true' to try the banner in development. For production, 1) Update the string in 'pro_banner' action, 2) set an appriopiate condition for when you want the banner to appear, such as '!has_paid_subscription && eventCount(app_start) % 3 == 0' to show it to unpaid users on every 3rd launch.",
          "condition": "false",
          "eventName": "app_start",
          "actionName": "pro_banner"
      },
      "requestAppUpdate": {
          "TODO": "Shows UI to users on old/buggy releases, requesting they upgrade their app. To implement: 1) Replace the '1.0.0' with the min acceptable app version, 2) optionally add specific buggy releases numbers to the array check to request those versions upgrade as well (even if they are newer than the min version).",
          "condition": "versionLessThan(app_version, '1.0.0') || app_version in []",
          "eventName": "app_start",
          "actionName": "suggest_app_upgrade"
      },
      "forceAppUpdate": {
          "TODO": "Shows UI to users on old/buggy releases, forcing them to upgrade the app (no skip option). To implement: 1) Replace the '1.0.0' with the min acceptable app version, 2) optionally add specific buggy releases numbers to the array check to request those versions upgrade as well (even if they are newer than the min version).",
          "condition": "versionLessThan(app_version, '1.0.0') || app_version in []",
          "eventName": "app_start",
          "actionName": "force_app_upgrade"
      },
      "whatsNewTrigger": {
          "TODO": "Shows a 'what's new' modal on startup. 1) replace content in 'whats_new_modal' with information about your app update, 2) update the condition version number check to the version number including these new features, 3) update the condition date check to when this version was released (so new user's don't see 'whats new'), 4) if this isn't your first 'whats new' modal, change the name of the 'whats_new_modal' action to something new, in both the condition here, and action section below. This ensures each announcement will appear exactly once (even if they saw the past modal).",
          "eventName": "app_start",
          "condition": "!versionLessThan(app_version, '2.0.0') && app_install_date < date('2025-01-01') && eventCount('action:whats_new_modal') == 0",
          "actionName": "whats_new_modal"
      }
    }
  },
  "actions": {
    "namedActions": {
      "smartReviewAction": {
        "actionType": "review_prompt",
        "actionData": {},
        "dev_comment": "don't show for 21 days (504h) after shown, min app version check, and some best practices for times to avoid",
        "condition": "(eventCount('system_app_review_requested') == 0 || latestEventTime('system_app_review_requested') < now() - duration('504h')) && versionGreaterThan(app_version, '1.0.0') && !device_low_power_mode && has_active_network && !low_data_mode && device_battery_level > 0.2 && !versionLessThan(os_version, '17.0') && locale_language_code == 'en'"
      },
      "smartPaywallReminderAction": {
          "actionType": "link",
          "dev_comment": "user is logged in, don't show for 7 days (168h) after shown by this action (excludes user-driven taps), and some best practices for times to avoid (low battery, network)",
          "condition": "!(has_paid_subscription ?? false) && eventCount('completed_onboarding') > 0 && (eventCount('action:smartPaywallReminderAction') == 0 || latestEventTime('action:smartPaywallReminderAction') < now() - duration('168h')) && !device_low_power_mode && has_active_network && !low_data_mode && device_battery_level > 0.2",
          "actionData": {
            "url": "yourapp://show_paywall"
          }
      },
      "suggest_app_upgrade": {
          "actionType": "modal",
          "actionData": {
              "showCloseButton": true,
              "content": {
                  "pageType": "stack",
                  "pageData": {
                      "sections": [
                          {
                              "pageSectionType": "image",
                              "topSpacingScale": 3,
                              "pageSectionData": {
                                  "imageType": "sf_symbol",
                                  "height": 80.0,
                                  "imageData": {
                                      "symbolName": "arrow.down.circle.fill",
                                      "mode": "hierarchical"
                                  }
                              }
                          },
                          {
                              "pageSectionType": "title",
                              "topSpacingScale": 2,
                              "pageSectionData": {
                                  "title": "App Update Recommended"
                              }
                          },
                          {
                              "pageSectionType": "body",
                              "topSpacingScale": 3,
                              "pageSectionData": {
                                  "bodyText": "Your app is out of date.\n\nWe suggest updating in the app store for the best experience.",
                                  "scaleFactor": 1.3
                              }
                          }
                      ],
                      "buttons": [
                          {
                              "title": "Update Now",
                              "style": "large",
                              "actionName": "update_app_action"
                          },
                          {
                              "title": "Not Now",
                              "style": "info"
                          }
                      ]
                  }
              }
          }
      },
      "force_app_upgrade": {
          "actionType": "modal",
          "actionData": {
              "showCloseButton": false,
              "content": {
                  "pageType": "stack",
                  "pageData": {
                      "sections": [
                          {
                              "pageSectionType": "image",
                              "topSpacingScale": 3,
                              "pageSectionData": {
                                  "imageType": "sf_symbol",
                                  "height": 80.0,
                                  "imageData": {
                                      "symbolName": "arrow.down.circle.fill",
                                      "mode": "hierarchical"
                                  }
                              }
                          },
                          {
                              "pageSectionType": "title",
                              "topSpacingScale": 2,
                              "pageSectionData": {
                                  "title": "App Update Required"
                              }
                          },
                          {
                              "pageSectionType": "body",
                              "topSpacingScale": 3,
                              "pageSectionData": {
                                  "bodyText": "Your app is out of date. You must update in the app store.",
                                  "scaleFactor": 1.3
                              }
                          }
                      ],
                      "buttons": [
                          {
                              "title": "Update Now",
                              "style": "large",
                              "preventDefault": true,
                              "actionName": "update_app_action"
                          }
                      ]
                  }
              }
          }
      },
      "update_app_action": {
          "actionType": "link",
          "actionData": {
              "TODO": "Replace this with your app ID, and remove this comment",
              "url": "itms-apps://itunes.apple.com/app/id324684580"
          }
      },
      "whats_new_modal": {
          "actionType": "modal",
          "actionData": {
              "showCloseButton": false,
              "content": {
                  "pageType": "stack",
                  "pageData": {
                      "sections": [
                          {
                              "pageSectionType": "image",
                              "topSpacingScale": 3,
                              "pageSectionData": {
                                  "imageType": "sf_symbol",
                                  "height": 80.0,
                                  "imageData": {
                                      "symbolName": "star.square.fill",
                                      "mode": "hierarchical"
                                  }
                              }
                          },
                          {
                              "pageSectionType": "title",
                              "topSpacingScale": 2,
                              "pageSectionData": {
                                  "title": "What's New in YourApp"
                              }
                          },
                          {
                              "pageSectionType": "title",
                              "topSpacingScale": 5,
                              "pageSectionData": {
                                  "title": "Feature One",
                                  "scaleFactor": 0.6
                              }
                          },
                          {
                              "pageSectionType": "body",
                              "topSpacingScale": 0.7,
                              "pageSectionData": {
                                  "bodyText": "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt",
                                  "scaleFactor": 1.1
                              }
                          },
                          {
                              "pageSectionType": "title",
                              "topSpacingScale": 4,
                              "pageSectionData": {
                                  "title": "Feature Two",
                                  "scaleFactor": 0.6
                              }
                          },
                          {
                              "pageSectionType": "body",
                              "topSpacingScale": 0.7,
                              "pageSectionData": {
                                  "bodyText": "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt",
                                  "scaleFactor": 1.1
                              }
                          }
                      ],
                      "buttons": [
                          {
                              "title": "Continue",
                              "style": "large"
                          }
                      ]
                  }
              }
          }
      },
      "pro_banner": {
        "actionType": "banner",
        "actionData": {
          "body": "Explore Pro Features →",
          "tapActionName": "pro_info_modal"
        }
      },
      "pro_info_action": {
        "actionType": "link",
        "actionData": {
          "url": "https://www.yourapp.com/pricing",
          "useEmbeddedBrowser": true
        }
      },
      "pro_info_modal": {
        "actionType": "modal",
        "actionData": {
          "content": {
            "pageType": "stack",
            "pageData": {
              "sections": [
                  {
                      "pageSectionType": "image",
                      "topSpacingScale": 3,
                      "pageSectionData": {
                          "imageType": "sf_symbol",
                          "height": 80.0,
                          "imageData": {
                              "symbolName": "list.bullet.rectangle.portrait.fill",
                              "mode": "hierarchical"
                          }
                      }
                },
                {
                  "pageSectionType": "title",
                  "topSpacingScale": 5.0,
                  "pageSectionData": {
                    "title": "Try Pro for Free"
                  }
                },
                {
                  "pageSectionType": "title",
                  "topSpacingScale": 1.5,
                  "pageSectionData": {
                    "title": "Get even more from YOUR_APP",
                    "scaleFactor": 0.64
                  }
                },
                {
                  "pageSectionType": "body",
                  "topSpacingScale": 4,
                  "pageSectionData": {
                    "bodyText": "Our pro plan is a great way to...",
                    "scaleFactor": 1.15
                  }
                }
              ],
              "buttons": [
                {
                  "title": "Got it!",
                  "style": "large"
                },
                {
                  "title": "Learn more about Pro",
                  "preventDefault": true,
                  "style": "info",
                  "actionName": "pro_info_action"
                }
              ]
            }
          }
        }
      }
    }
  },
  "notifications": {
    "onboardingReminder": {
      "title": "Complete APP_NAME Setup",
      "body": "It only takes 3 minutes to start APP_VALUE.",
      "cancelationEvents": ["completed_onboarding"],
      "deliveryTimeOfDayStart": "10:00",
      "deliveryTimeOfDayEnd": "20:00",
      "deliveryTime": {
        "eventName": "app_entered_background",
        "eventInstance": "latest-once",
        "eventOffsetSeconds": 900
      }
    },
    "secondOnboardingReminder": {
        "title": "Complete APP_NAME Setup",
        "body": "It only takes 3 minutes to start APP_VALUE.",
      "cancelationEvents": ["completed_onboarding"],
      "deliveryTimeOfDayStart": "10:00",
      "deliveryTimeOfDayEnd": "20:00",
      "dev_note": "259,200s is 3 days, and 345,600s is 4 days - so this will be delivered between day 3 and day 7 after last app launch. It's canceled if the user creates an account (user_sync event). The ideal delivery time is when the user is holding their device (not flat), and it's screen is on.",
      "deliveryTime": {
        "eventName": "app_entered_background",
        "eventInstance": "latest-once",
        "eventOffsetSeconds": 259200
      },
      "idealDeliveryConditions": {
        "condition": "screen_brightness > 0.01 && device_orientation != 'face_up' && device_orientation != 'face_down'",
        "maxWaitTimeSeconds": 345600
      }
    },
    "churnNotification": {
      "title": "APP_VALUE",
      "body": "APP_VALUE_2",
      "deliveryTimeOfDayStart": "10:00",
      "deliveryTimeOfDayEnd": "20:00",
      "dev_note": "2,592,000s is 30 days, and 345,600s is 4 days - so this will be delivered between day 30 and day 34 after last app launch. The ideal delivery time is when the user is holding their device (not flat), and it's screen is on.",
      "deliveryTime": {
        "eventName": "app_entered_foreground",
        "eventInstance": "latest",
        "eventOffsetSeconds": 2592000
      },
      "idealDeliveryConditions": {
        "condition": "screen_brightness > 0.01 && device_orientation != 'face_up' && device_orientation != 'face_down'",
        "maxWaitTimeSeconds": 345600
      }
    }
  },
  "themes": {
    "TODO": "Themes allow you to control the colors and fonts used in Critical Moments UI. To implement a theme: 1) update the 'primary_theme' below with the colors and fonts of your brand 2) set 'defaultThemeName' to 'primary_theme' to make it your default theme. See theme spec for details: https://docs.criticalmoments.io/themes/theme-overview",
    "defaultThemeName": "system",
    "namedThemes": {
      "primary_theme": {
        "bannerBackgroundColor": "#a7fe01",
        "bannerForegroundColor": "#ffffff",
        "fontName": "AvenirNext-Regular",
        "boldFontName": "AvenirNext-Bold",
        "backgroundColor": "#000000",
        "primaryTextColor": "#fafafa",
        "primaryColor": "#3a758c",
        "secondaryTextColor": "#a6a4a2"
      }
    }
  }
}
